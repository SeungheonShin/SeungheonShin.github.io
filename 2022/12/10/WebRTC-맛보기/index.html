<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.24.4"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css 1m3qj71">.css-1m3qj71{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;background-color:#282a36;height:100%;}</style><div class="css-1m3qj71 e1oj83b30"><style data-emotion="css-global z6trna">@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500&display=swap');*{padding:0;margin:0;box-sizing:border-box;font-family:'Noto Sans KR',sans-serif;}html,body,#___gatsby,#gatsby-focus-wrapper{height:100%;}body{background:#282a36;}a,a:hover{color:inherit;-webkit-text-decoration:none;text-decoration:none;}</style><style data-emotion="css 196ilw0">.css-196ilw0{position:relative;width:100%;background-color:#383a59;}</style><div class="css-196ilw0 e1opi4mu0"><style data-emotion="css kk9rhg">.css-kk9rhg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:20px;width:768px;height:200px;margin:0 auto;padding:60px 0 30px 0;}</style><div class="css-kk9rhg e1st1jau3"><style data-emotion="css 13ypecs">.css-13ypecs{display:-webkit-box;overflow:hidden;overflow-wrap:break-word;margin-top:auto;text-overflow:ellipsis;white-space:normal;-webkit-line-clamp:2;-webkit-box-orient:vertical;font-size:32px;font-weight:800;color:#f8f8f2;}</style><div class="css-13ypecs e1st1jau2">WebRTC 맛보기 - 프로젝트 Momyeon</div><style data-emotion="css 1c5wltq">.css-1c5wltq{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-top:10px;font-size:16px;font-weight:700;color:#f8f8f2;}</style><div class="css-1c5wltq e1st1jau0"><style data-emotion="css 1mkb7h">.css-1mkb7h{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:10px;color:rgba(248, 248, 242, 0.7);}.css-1mkb7h a:hover{color:#f8f8f2;}</style><div class="css-1mkb7h e1st1jau1"><a href="/?category=WebRTC">#WebRTC</a></div><div>2022.12.10.</div></div></div><style data-emotion="css c6hz5t">.css-c6hz5t{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:10px;position:absolute;right:0;top:0;padding:12px;}</style><div class="css-c6hz5t e2ioyhw0"><a href="/"><img src="https://cdn-icons-png.flaticon.com/512/25/25694.png" alt="Home" width="40px" height="40px"/></a><a href="https://github.com/SeungheonShin" target="_blank"><img src="https://cdn-icons-png.flaticon.com/512/25/25231.png" alt="Github" width="40px" height="40px"/></a></div></div><style data-emotion="css 1dnxuko">.css-1dnxuko{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;padding:0 200px 0 260px;}</style><div class="css-1dnxuko eqxa3d40"><style data-emotion="css ushp8e">.css-ushp8e{position:fixed;box-sizing:content-box;top:200px;left:0;margin:50px 30px;width:200px;border-right:1px solid #44475a;}.css-ushp8e ul{display:inline-block;list-style:decimal;}.css-ushp8e ul ul{padding-left:20px;}.css-ushp8e ul ul ul{padding-left:40px;}.css-ushp8e ul li{color:rgba(248, 248, 242, 0.7);padding:4px 0;}.css-ushp8e ul li:hover{color:#f8f8f2;}</style><div class="css-ushp8e etse75s0"><ul>
<li>
<p><a href="#webrtc-%EB%A7%9B%EB%B3%B4%EA%B8%B0">WebRTC 맛보기</a></p>
<ul>
<li>
<p><a href="#1-%EC%99%9C-webrtc%EB%A5%BC-%EC%93%B0%EB%82%98%EC%9A%94">1. 왜 WebRTC를 쓰나요?</a></p>
<ul>
<li><a href="#%EC%98%A8%EB%9D%BC%EC%9D%B8-%EB%AA%A8%EC%9D%98%EB%A9%B4%EC%A0%91-%EC%84%9C%EB%B9%84%EC%8A%A4-%EB%AA%A8%EB%A9%B4">온라인 모의면접 서비스, 모면!</a></li>
<li><a href="#%EC%B2%98%EC%9D%8C-%EC%A0%91%ED%95%98%EB%8A%94-%EA%B8%B0%EC%88%A0%EC%9D%84-%ED%95%99%EC%8A%B5%ED%95%98%EA%B8%B0">처음 접하는 기술을 학습하기</a></li>
</ul>
</li>
<li>
<p><a href="#2-webrtc%EB%9E%80">2. WebRTC란?</a></p>
<ul>
<li><a href="#%EC%9B%B9%EC%86%8C%EC%BC%93-%ED%86%B5%EC%8B%A0">웹소켓 통신</a></li>
<li><a href="#webrtc-%ED%86%B5%EC%8B%A0mesh-%EB%B0%A9%EC%8B%9D-%EA%B8%B0%EC%A4%80">WebRTC 통신(Mesh 방식 기준)</a></li>
<li><a href="#webrtc%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95%EB%93%A4">WebRTC를 사용하는 방법들</a></li>
</ul>
</li>
<li>
<p><a href="#3-%EA%B5%AC%ED%98%84%EC%9D%84-%EC%9C%84%ED%95%B4%EC%84%A0-%EC%A1%B0%EA%B8%88-%EB%8D%94">3. 구현을 위해선 조금 더..</a></p>
<ul>
<li><a href="#stun-turn-ice-%EA%B7%B8%EB%A6%AC%EA%B3%A0-rtc-peerconnection">STUN, TURN, ICE, 그리고 RTC PeerConnection</a></li>
</ul>
</li>
<li>
<p><a href="#4-%EA%B7%B8%EB%9E%98%EC%84%9C-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%93%B0%EB%8A%94%EB%8D%B0%EC%9A%94">4. 그래서 어떻게 쓰는데요?</a></p>
<ul>
<li><a href="#sdp-%EC%A3%BC%EA%B3%A0%EB%B0%9B%EA%B8%B0--ice-%EC%84%9C%EB%B2%84-%EC%97%B0%EA%B2%B0-%EC%9D%B4%EC%A0%84">SDP 주고받기 ~ ICE 서버 연결 이전</a></li>
<li><a href="#ice-%EC%97%B0%EA%B2%B0--%EC%97%B0%EA%B2%B0-%EC%99%84%EB%A3%8C">ICE 연결 ~ 연결 완료</a></li>
</ul>
</li>
<li>
<p><a href="#5-%EB%AA%A8%EB%A9%B4-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%EC%97%90%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%93%B0%EB%82%98%EC%9A%94">5. 모면 프로젝트에는 어떻게 쓰나요?</a></p>
</li>
<li>
<p><a href="#%EC%B0%B8%EA%B3%A0">참고</a></p>
</li>
</ul>
</li>
</ul></div><style data-emotion="css 12ci2wn">.css-12ci2wn{font-family:'Times New Roman';-webkit-flex:1;-ms-flex:1;flex:1;width:768px;margin:0 auto;padding:100px 0;word-break:break-all;line-height:1.8;font-size:16px;font-weight:400;color:#f8f8f2;}.css-12ci2wn p{padding:5px 0;}.css-12ci2wn p code{background:#383a59;border:1px solid #ff79c6;border-radius:5px;padding:0 2px;}.css-12ci2wn h1,.css-12ci2wn h2,.css-12ci2wn h3{font-weight:800;margin-bottom:15px;}.css-12ci2wn *+h1,.css-12ci2wn *+h2,.css-12ci2wn *+h3{margin-top:30px;}.css-12ci2wn hr+h1,.css-12ci2wn hr+h2,.css-12ci2wn hr+h3{margin-top:0;}.css-12ci2wn h1{font-size:30px;}.css-12ci2wn h2{font-size:25px;}.css-12ci2wn h3{font-size:20px;}.css-12ci2wn blockquote{margin:30px 0;padding:5px 15px;border-left:2px solid #f8f8f2;font-weight:800;background:#44475a;}.css-12ci2wn ol,.css-12ci2wn ul{margin-left:20px;padding:30px 0;}.css-12ci2wn hr{border:1px solid #000000;margin:100px 0;}.css-12ci2wn a{color:#8be9fd;-webkit-text-decoration:none;text-decoration:none;}.css-12ci2wn a:hover{-webkit-text-decoration:underline;text-decoration:underline;}.css-12ci2wn deckgo-highlight-code{--deckgo-highlight-code-carbon-background:#2f3147;--deckgo-highlight-code-token-comment:#f1fa8c;--deckgo-highlight-code-token-punctuation:rgba(248, 248, 242, 0.7);}</style><div class="css-12ci2wn e1ijh0y10"><h1 id="webrtc-맛보기" style="position:relative;"><a href="#webrtc-%EB%A7%9B%EB%B3%B4%EA%B8%B0" aria-label="webrtc 맛보기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>WebRTC 맛보기</h1>
<p>해당 글은 <a href="https://github.com/boostcampwm-2022/web23_MoMyeon" target="_blank" rel="nofollow">MoMyeon 프로젝트</a> 진행 중 WebRTC에 대한 기본적인 개념을 공유하기 위해 작성한 글입니다.</p>
<h2 id="1-왜-webrtc를-쓰나요" style="position:relative;"><a href="#1-%EC%99%9C-webrtc%EB%A5%BC-%EC%93%B0%EB%82%98%EC%9A%94" aria-label="1 왜 webrtc를 쓰나요 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 왜 WebRTC를 쓰나요?</h2>
<h3 id="온라인-모의면접-서비스-모면" style="position:relative;"><a href="#%EC%98%A8%EB%9D%BC%EC%9D%B8-%EB%AA%A8%EC%9D%98%EB%A9%B4%EC%A0%91-%EC%84%9C%EB%B9%84%EC%8A%A4-%EB%AA%A8%EB%A9%B4" aria-label="온라인 모의면접 서비스 모면 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>온라인 모의면접 서비스, 모면!</h3>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 340px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/e39f6b1895124252e0a010cf5b334e76/f46e7/201805789-52ef3a88-13cd-4b58-9f85-fb7da8f1fa13.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 48.958333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABsUlEQVQoz32SXUsbURCG/R/9Ib3yph93elMoWuhdC0GKVSq0WFtooYgGpBdRpKCgxSpiVFCx0N40WvwGQbxoxUjUNInZ7MbFpO7uOXse2cXoZlM7MIeZOe/MeYfz1imlCJtUikpdBeKghe8reZ13uFKR0SVLOQvDcmuaXFchA+7Vg3kQ7w+0HcWT90Uaugt0JUyWcxa2vBz2D3Zhs4VbzVAIRXOXwb2OAneeazz4pDO8W75qmN8+5e30Hz7MZYl9z3NiOkQXc3TPZ5lY1emcSl897A90hKLptU7r4inxxF/qIxq9m2feDj7o6XCK0Z8FMkWHxo/7fN0xiYwc0jFxzK32HR72J6tXllLx+I1BbKnEXk5wt12jb+vMg/jAyXWDltFDnn0+omchSzJv0TZ25PuL8WOaBg6uV64Ev1MC21ak0oLbkTxRjyFQtl3WkiVeTqa5H93j265JyZKMrejENw0fM7JcqF45KAvNkLyKmfzShZ+fOy7xDYMvKzpTGwZDPzT0kmBmq8ijwQPezWYYSmi1DD1puIH4Ugj//V1HKp9t2Qr9clio14KlRnMVHd4k9guIFOHya9wnLwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/e39f6b1895124252e0a010cf5b334e76/a59e9/201805789-52ef3a88-13cd-4b58-9f85-fb7da8f1fa13.webp 192w,
/static/e39f6b1895124252e0a010cf5b334e76/719ab/201805789-52ef3a88-13cd-4b58-9f85-fb7da8f1fa13.webp 340w"
              sizes="(max-width: 340px) 100vw, 340px"
              type="image/webp"
            />
          <source
            srcset="/static/e39f6b1895124252e0a010cf5b334e76/3b721/201805789-52ef3a88-13cd-4b58-9f85-fb7da8f1fa13.png 192w,
/static/e39f6b1895124252e0a010cf5b334e76/f46e7/201805789-52ef3a88-13cd-4b58-9f85-fb7da8f1fa13.png 340w"
            sizes="(max-width: 340px) 100vw, 340px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/e39f6b1895124252e0a010cf5b334e76/f46e7/201805789-52ef3a88-13cd-4b58-9f85-fb7da8f1fa13.png"
            alt="201805789-52ef3a88-13cd-4b58-9f85-fb7da8f1fa13.png"
            title="201805789-52ef3a88-13cd-4b58-9f85-fb7da8f1fa13.png"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p><img src="%25EC%25BA%25A1%25EC%25B2%25983.png" alt="캡처3.PNG"></p>
<ul>
<li>웹에서 동작하는 면접 애플리케이션이 필요하다.
<ul>
<li>즉, 영상과 음성을 클라이언트끼리 실시간으로 주고받아야한다.</li>
<li>부캠타운에 사용했던 웹소켓으로도 가능하지 않을까?
<ul>
<li>가능 하다! 하지만 미디어, 특히 영상/음성 통신에는 webRTC라는 api를 사용하면 더 높은 성능의 앱을 만들 수 있다.</li>
</ul>
</li>
<li>webRTC만 있을까?
<ul>
<li>세상은 넓고 프로토콜은 많다.. HLS, RTMP, RTSP, 등등..</li>
<li>HTTP 지원, HTML5 지원, 레퍼런스 문서 접근성, 오픈소스 여부 등을 따져봤을 때 webRTC가 가장 적절하다고 판단했다.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="처음-접하는-기술을-학습하기" style="position:relative;"><a href="#%EC%B2%98%EC%9D%8C-%EC%A0%91%ED%95%98%EB%8A%94-%EA%B8%B0%EC%88%A0%EC%9D%84-%ED%95%99%EC%8A%B5%ED%95%98%EA%B8%B0" aria-label="처음 접하는 기술을 학습하기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>처음 접하는 기술을 학습하기</h3>
<ul>
<li>WebRTC를 써야겠다.. 근데 이거 어떻게 쓰지? (아무도 모름)
<ul>
<li>2주차는 팀원 모두가 학습에 집중하자!</li>
<li>기존에 진행하던 프론트엔드 / 백엔드 개발은 잠시 일시정지 ⛔</li>
<li>공식문서, 영상 강의, <strong>멘토님(webRTC 고수)</strong> 등등.. 자료를 공유하며 학습</li>
</ul>
</li>
</ul>
<h2 id="2-webrtc란" style="position:relative;"><a href="#2-webrtc%EB%9E%80" aria-label="2 webrtc란 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. WebRTC란?</h2>
<blockquote>
<p><strong>WebRTC</strong> (Web Real-Time Communication): 웹을 위한 실시간 커뮤니케이션 - <a href="https://webrtc.org/" target="_blank" rel="nofollow">WebRTC</a></p>
</blockquote>
<p>위키에서는 WebRTC를 <strong>‘웹 브라우저끼리 실시간으로 통신할 수 있도록 설계된 API’</strong> 라고 설명한다.</p>
<p>여기서 중요한 부분은 <strong><code>웹 브라우저끼리</code></strong> 통신한다는 점이다.</p>
<h3 id="웹소켓-통신" style="position:relative;"><a href="#%EC%9B%B9%EC%86%8C%EC%BC%93-%ED%86%B5%EC%8B%A0" aria-label="웹소켓 통신 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>웹소켓 통신</h3>
<p><img src="%25EC%25BA%25A1%25EC%25B2%25984.png" alt="캡처4.PNG"></p>
<ul>
<li>브라우저의 영상/음성 데이터를 항상 웹소켓 서버를 거쳐 주고받는다.</li>
<li>레이턴시가 높다. TCP 프로토콜을 사용하므로 스트리밍에 상대적으로 부적합하다.</li>
</ul>
<h3 id="webrtc-통신mesh-방식-기준" style="position:relative;"><a href="#webrtc-%ED%86%B5%EC%8B%A0mesh-%EB%B0%A9%EC%8B%9D-%EA%B8%B0%EC%A4%80" aria-label="webrtc 통신mesh 방식 기준 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>WebRTC 통신(Mesh 방식 기준)</h3>
<p><img src="%25EC%25BA%25A1%25EC%25B2%25985.png" alt="캡처5.PNG"></p>
<ul>
<li>시그널링(브라우저끼리 최초 연결)은 웹소켓 서버로, 이후 영상/음성 데이터는 직접 주고받는다.</li>
<li>레이턴시가 낮다. 주로 UDP, *RTP 등의 실시간 통신 목적의 프로토콜을 사용한다.</li>
<li>브라우저의 부담이 상대적으로 크다. (연결 방식에 따라 다름)</li>
</ul>
<blockquote>
<p>💡 <strong>RTP(Real Time Transport Protocol)</strong>: UDP를 기반으로 하는 프로토콜. 인코딩/디코딩 정보, 패킷 손실 감지 등의 기능을 하며 UDP에 비해 성능이 높고 효율적이다.</p>
</blockquote>
<h3 id="webrtc를-사용하는-방법들" style="position:relative;"><a href="#webrtc%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95%EB%93%A4" aria-label="webrtc를 사용하는 방법들 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>WebRTC를 사용하는 방법들</h3>
<ul>
<li>WebRTC라고 검색하면 가장먼저 나오는 사진들..</li>
</ul>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/7e8674ea2d546641a400295ef5695d9d/de412/121813880-62251b80-cc6e-11eb-999f-f10e11a14850.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 32.8125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABdElEQVQoz12RXW/TMBSG8+MrAb+Aa4QEXHCJgKFW2iS2km7QtMtEV5amWdLlY0lG89E6qeMHzYMO8I3f9zw+PrZeQwGN2LItc/5f6vdeFxnttnioKfXIlaJap8im1ofvvXEP3MUl5tFLRB4h6pJ219G1DWondOOZbRE4n/dDunaLkq32w9MBeTjZM2N48JxrZ0aehGRxwvTwE5P+W7Loim/Hryg3OxZ+SCPh4vAd/sUpN8sxky9vSJKU6blJFLpYH18TOTaGe5MQ+tckPxvSJCVPbqlqgex2euKPZUKv95SNBLHOqPKYVkr9npOj9zx70qNta8rbkLrIMYLxB4Ig5K5syIqGufUV7+q7/sI6sHDtPkJCsPRwbBOlOs3i2QD3/IBaKOYTE29u6bphnrzgrqioNy1VA8vxkMtRX0N/ZRN4I63L2GdxNkB2UnvHHZHGM61zd4Y3PX648E9iYRgjhNgn2HXdXq9WIVI9Rv930nGU/JP6L7ZzDTOlzFtNAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/7e8674ea2d546641a400295ef5695d9d/a59e9/121813880-62251b80-cc6e-11eb-999f-f10e11a14850.webp 192w,
/static/7e8674ea2d546641a400295ef5695d9d/0ca9f/121813880-62251b80-cc6e-11eb-999f-f10e11a14850.webp 384w,
/static/7e8674ea2d546641a400295ef5695d9d/dc9b9/121813880-62251b80-cc6e-11eb-999f-f10e11a14850.webp 768w,
/static/7e8674ea2d546641a400295ef5695d9d/e2c2f/121813880-62251b80-cc6e-11eb-999f-f10e11a14850.webp 1152w,
/static/7e8674ea2d546641a400295ef5695d9d/f3efb/121813880-62251b80-cc6e-11eb-999f-f10e11a14850.webp 1536w,
/static/7e8674ea2d546641a400295ef5695d9d/1e927/121813880-62251b80-cc6e-11eb-999f-f10e11a14850.webp 1868w"
              sizes="(max-width: 768px) 100vw, 768px"
              type="image/webp"
            />
          <source
            srcset="/static/7e8674ea2d546641a400295ef5695d9d/3b721/121813880-62251b80-cc6e-11eb-999f-f10e11a14850.png 192w,
/static/7e8674ea2d546641a400295ef5695d9d/66595/121813880-62251b80-cc6e-11eb-999f-f10e11a14850.png 384w,
/static/7e8674ea2d546641a400295ef5695d9d/fe486/121813880-62251b80-cc6e-11eb-999f-f10e11a14850.png 768w,
/static/7e8674ea2d546641a400295ef5695d9d/d2d74/121813880-62251b80-cc6e-11eb-999f-f10e11a14850.png 1152w,
/static/7e8674ea2d546641a400295ef5695d9d/e8464/121813880-62251b80-cc6e-11eb-999f-f10e11a14850.png 1536w,
/static/7e8674ea2d546641a400295ef5695d9d/de412/121813880-62251b80-cc6e-11eb-999f-f10e11a14850.png 1868w"
            sizes="(max-width: 768px) 100vw, 768px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/7e8674ea2d546641a400295ef5695d9d/fe486/121813880-62251b80-cc6e-11eb-999f-f10e11a14850.png"
            alt="121813880-62251b80-cc6e-11eb-999f-f10e11a14850.png"
            title="121813880-62251b80-cc6e-11eb-999f-f10e11a14850.png"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<ul>
<li>
<p><strong>Mesh:</strong> 브라우저가 모든 부담을 가진다.</p>
<ul>
<li>위에서 설명한 브라우저 끼리 통신하는 경우에 해당</li>
</ul>
</li>
<li>
<p><strong>MCU (Multipoint Control Unit):</strong> 중간에 있는 서버가 통신하는 브라우저의 데이터를 하나로 합쳐 전송한다.</p>
<ul>
<li>`서버에서 합치는 비용이 크다.</li>
</ul>
</li>
<li>
<p><strong>SFU (Selective Forwarding Unit):</strong> 중간에 있는 서버가 각 브라우저의 요청/응답 스트림을 라우팅한다.</p>
<ul>
<li>Mesh에서 클라이언트의 부담을 서버로 일부 옮긴 방식.</li>
<li>다수의 경우 여전히 브라우저의 부담이 크다.</li>
<li>zoom이 초기에 사용한 방식이지만, 현재는 webRTC의 일부와 웹어셈블리를 함께 쓰는 독자적인 방식을 사용한다.</li>
</ul>
</li>
</ul>
<h2 id="3-구현을-위해선-조금-더" style="position:relative;"><a href="#3-%EA%B5%AC%ED%98%84%EC%9D%84-%EC%9C%84%ED%95%B4%EC%84%A0-%EC%A1%B0%EA%B8%88-%EB%8D%94" aria-label="3 구현을 위해선 조금 더 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 구현을 위해선 조금 더..</h2>
<ul>
<li>개념적인 부분은 이해된 것 같다. 근데 구현은 어떻게 시작하지?</li>
<li>위의 개념에 더해서 실제로 WebRTC를 사용하기 위해선 몇가지 개념을 더 알아야 한다.</li>
<li>용어들이 많다.. 무슨 역할인지만 간단하게 짚고 넘어가자</li>
</ul>
<h3 id="stun-turn-ice-그리고-rtc-peerconnection" style="position:relative;"><a href="#stun-turn-ice-%EA%B7%B8%EB%A6%AC%EA%B3%A0-rtc-peerconnection" aria-label="stun turn ice 그리고 rtc peerconnection permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>STUN, TURN, ICE, 그리고 RTC PeerConnection</h3>
<ul>
<li>
<p>네트워크 방화벽 때문에 바로 직접적인 연결을 하기 어렵다.</p>
</li>
<li>
<p>public IP를 알기 위해 STUN, TURN 서버를 추가적으로 사용해야 한다!</p>
</li>
<li>
<p>*<em><strong>STUN (Session Traversal Utilities for <em>NAT)</em></strong></em></p>
<ul>
<li>피어가 요청하면 피어의 public IP를 알려준다. 이후 webRTC 통신에선 관여하지 않는다.</li>
</ul>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 500px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/7ee961a1134b2ade0b94275fd10e80d7/0eb09/3100OS_04_01.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 60.416666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABmUlEQVQoz22Raw+bIBSG/f9/r03MJFqhVSsilcsBAYGtsnTdsucbyXk4l7fats1aa75gjFFKGWOvk2VZ5nlmjH0KACCE0DRN5ZzLX6SUhBA5Z6VU13X3OwGAnLMQIqX0qck5E0Kqfd+/5eM4iiyEqOsaoUYplXOWUh7HkU5ijDlnjHFlrZVSAoBSSmsdQijyuq5d1/Z9D6A/nf+VtdaEkHEcx2EYxhEhJKUUQpS/tFZKSSkl57zv+9L8j/wZO6WktaaUOufiyXESY0wpWWvneVZK/UdOKSmlOOfe+/w3ZdScszGGc26MKc/fsvc+hDAMAyHEGCOl3LbNmHd+SqnvUccT731K6S1LKdu2RQg9n895njHGz+dEKeWcU0qnaQohlBRSilLK5kdzu904XxFCFWNs2151XXvvH4/HsizrumLcnz2Gx+OOMe66bl1XABAnl8tl3/fr9VpxzgGgLCM2AQDj++ZNcbqubdu2aZrX6zVN07Is1lpyJzHGuq7fOQPAmYo+jsM5Vy78OXUhhGCMCSFo/Y7QOfdr559AWKkqshHOAAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/7ee961a1134b2ade0b94275fd10e80d7/a59e9/3100OS_04_01.webp 192w,
/static/7ee961a1134b2ade0b94275fd10e80d7/0ca9f/3100OS_04_01.webp 384w,
/static/7ee961a1134b2ade0b94275fd10e80d7/601b1/3100OS_04_01.webp 500w"
              sizes="(max-width: 500px) 100vw, 500px"
              type="image/webp"
            />
          <source
            srcset="/static/7ee961a1134b2ade0b94275fd10e80d7/3b721/3100OS_04_01.png 192w,
/static/7ee961a1134b2ade0b94275fd10e80d7/66595/3100OS_04_01.png 384w,
/static/7ee961a1134b2ade0b94275fd10e80d7/0eb09/3100OS_04_01.png 500w"
            sizes="(max-width: 500px) 100vw, 500px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/7ee961a1134b2ade0b94275fd10e80d7/0eb09/3100OS_04_01.png"
            alt="3100OS_04_01.webp"
            title="3100OS_04_01.webp"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
</li>
</ul>
<blockquote>
<p>💡 <strong>NAT :</strong> 외부 IP 요청이 라우터를 경유하도록 하는 기술, 방화벽 기능</p>
</blockquote>
<ul>
<li><strong>TURN</strong> (<strong><strong>Traversal Using Relays around NAT)</strong></strong>
<ul>
<li>*Symmetric NAT 환경에서 STUN만으로는 직접 연결이 어렵다. 이럴 때 사용된다.
<ul>
<li>즉 STUN 서버 먼저 확인한 뒤, 연결이 안된다면 TURN서버를 사용하는 식</li>
</ul>
</li>
<li>STUN과 마찬가지로 public IP를 알려주며, 이후 피어끼리 통신에도 중간에 관여하며 미디어 스트림을 중개하는 relay 방식으로 작동한다.</li>
</ul>
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 500px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/fd9b4e9d620a8c901fd3a0e0930e1d9c/0eb09/3100OS_04_02.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 54.6875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABhElEQVQoz23Q0ZajIAwGYN//9XraGadaqRULCoqGIKjAnpVpZ+ec/a64yJ+QZIi4rqv9TQghpWzbljE2DIOU0lrrXqy13ntKabZtW/xt33dENGa5XM55/rnvu9bae/8uCCHEGPu+z9Z1jTEioj4sy7JtmzEGUef5Z1FcvffvsPc+hJDeXddlzrkYI+ecUiqEIIQwxrTW8zxPk5qmCQC01pRSRExjf8JpcvqJtVYd/Esq3fd9HEc1Kmvtf8Jpz2malmX5d//w4r0HAKXUsiwpzDn/e7AQgjGGUvpoHpzz5/OplBqGQQiRYu8O8zy3LbXWfk9WSjHGxCEdDBFTi6qq+r4DgHme014hhOdBKdU0TSaEKIqCkAoACKnyPCeEGGPWdb1evz4+LjGGcVT5YZoUAJxOJ845ISQzBwBwziHqur5zzq21iKYorvc7CSEAAKVN21LGmHNOSumca9s2q+u6qqrb7UYp7bpOStn3fVmWt1t5PVQHIUQvRNd1TdOUZfl4PM7n8x/1pW5wcicgTAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/fd9b4e9d620a8c901fd3a0e0930e1d9c/a59e9/3100OS_04_02.webp 192w,
/static/fd9b4e9d620a8c901fd3a0e0930e1d9c/0ca9f/3100OS_04_02.webp 384w,
/static/fd9b4e9d620a8c901fd3a0e0930e1d9c/601b1/3100OS_04_02.webp 500w"
              sizes="(max-width: 500px) 100vw, 500px"
              type="image/webp"
            />
          <source
            srcset="/static/fd9b4e9d620a8c901fd3a0e0930e1d9c/3b721/3100OS_04_02.png 192w,
/static/fd9b4e9d620a8c901fd3a0e0930e1d9c/66595/3100OS_04_02.png 384w,
/static/fd9b4e9d620a8c901fd3a0e0930e1d9c/0eb09/3100OS_04_02.png 500w"
            sizes="(max-width: 500px) 100vw, 500px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/fd9b4e9d620a8c901fd3a0e0930e1d9c/0eb09/3100OS_04_02.png"
            alt="3100OS_04_02.webp"
            title="3100OS_04_02.webp"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></li>
</ul>
<blockquote>
<p>💡 <strong>Symmetric NAT :</strong> 외부에서 요청하는 서버마다 다른 포트를 매핑하는 NAT</p>
</blockquote>
<ul>
<li>
<p><strong>ICE(Interactive Connectivity Establishment)</strong></p>
<ul>
<li>STUN, TURN 서버를 이용해 통신이 가능한 경로를 찾아주는 프레임워크</li>
<li>ICE만으로는 public ip를 알지 못하고, ICE+STUN 서버, ICE+TURN 서버 등의 조합으로 사용한다.</li>
<li>코드로 보면 이해가 쉽다. 이후 RTC PeerConnection을 생성할 때 옵션으로 사용된다.</li>
</ul>
<deckgo-highlight-code language="jsx" theme="dracula" line-numbers="true"  >
          <code slot="code">const rtcConfig = {
  // ICE 서버의 설정. 내용으로 TURN, STUN 서버의 url이 들어간다.
  iceServers: [
    {
      urls: [&#39;turn:turn-test.ml:3478?transport=tcp&#39;],
      username: &#39;hello&#39;,
      credential: &#39;world&#39;,
    },
  ],
};</code>
        </deckgo-highlight-code>
</li>
<li>
<p><strong>RTC PeerConnection</strong></p>
<ul>
<li>webRTC로 다른 피어와 연결할 수 있도록 해주는 인터페이스</li>
<li>위의 ICE, TURN/STUN 서버 설정을 사용해 RTC PeerConnection 객체를 생성하고 이후 연결에 쓰인다.</li>
</ul>
<deckgo-highlight-code language="jsx" theme="dracula" line-numbers="true"  >
          <code slot="code">const peerConnection = new RTCPeerConnection(rtcConfig);</code>
        </deckgo-highlight-code>
</li>
</ul>
<h2 id="4-그래서-어떻게-쓰는데요" style="position:relative;"><a href="#4-%EA%B7%B8%EB%9E%98%EC%84%9C-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%93%B0%EB%8A%94%EB%8D%B0%EC%9A%94" aria-label="4 그래서 어떻게 쓰는데요 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 그래서 어떻게 쓰는데요?</h2>
<ul>
<li>이론의 향연.. 그래서 실제 코드는 어떻게 쓰나요?</li>
<li>1:1 화상채팅을 구현한 코드의 일부를 같이 확인해보자!</li>
<li>코드는 Mesh방식의 1:1 화상채팅을 구현한 것의 일부이다.
<ul>
<li><strong>다음 코드를 참고했습니다.</strong></li>
<li><a href="https://github.com/jasonkang14/webrtc-web-one-to-one-client" target="_blank" rel="nofollow">https://github.com/jasonkang14/webrtc-web-one-to-one-client</a></li>
</ul>
</li>
<li>2가지 단계로 나눠서 보자.
<ul>
<li>SDP 주고받기 ~ ICE 연결 이전</li>
<li>ICE 연결 ~ 연결 완료</li>
</ul>
</li>
</ul>
<h3 id="sdp-주고받기--ice-서버-연결-이전" style="position:relative;"><a href="#sdp-%EC%A3%BC%EA%B3%A0%EB%B0%9B%EA%B8%B0--ice-%EC%84%9C%EB%B2%84-%EC%97%B0%EA%B2%B0-%EC%9D%B4%EC%A0%84" aria-label="sdp 주고받기  ice 서버 연결 이전 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>SDP 주고받기 ~ ICE 서버 연결 이전</h3>
<ul>
<li>offer를 전송할때 프로토콜은 RTC SDP(Session Description Protocol)를 사용한다.</li>
</ul>
<p><img src="%25EC%25BA%25A1%25EC%25B2%259810.png" alt="캡처10.PNG"></p>
<ul>
<li>local offer를 생성해서 시그널링 서버에 전송한다.</li>
</ul>
<deckgo-highlight-code language="jsx" theme="dracula" line-numbers="true"  >
          <code slot="code">const rtcConfig = {
  // ICE 서버의 설정. 내용으로 TURN, STUN 서버의 url이 들어간다.
  iceServers: [
    {
      urls: [&#39;turn:turn-test.ml:3478?transport=tcp&#39;],
      username: &#39;hello&#39;,
      credential: &#39;world&#39;,
    },
  ],
};
const peerConnection = new RTCPeerConnection(rtcConfig);

// pcRef는 RTC peer connection을 가리키는 useRef 객체이다.
const createNewOffer = async () =&gt; {
  // 생략..
  const newOffer = await pcRef.current.createOffer();
  await pcRef.current.setLocalDescription(newOffer);

  socketRef.current.emit(&#39;new-offer&#39;, {
    offer: newOffer,
    roomId: roomIdRef.current,
  });
};</code>
        </deckgo-highlight-code>
<ul>
<li>참가자가 이미 있을 때 offer를 받아 remote offer생성하고 local answer를 생성, 전송한다.</li>
</ul>
<deckgo-highlight-code language="jsx" theme="dracula" line-numbers="true"  >
          <code slot="code">const handleRemoteOffer = async (offer) =&gt; {
    // 생략..

    const remoteOffer = new RTCSessionDescription(offer);
    await pcRef.current.setRemoteDescription(remoteOffer);

    const newAnswer = await pcRef.current.createAnswer(remoteOffer);
    await pcRef.current.setLocalDescription(newAnswer);

    socketRef.current.emit(&#39;new-answer&#39;, {
      answer: newAnswer,
      roomId: roomIdRef.current,
    });
  };</code>
        </deckgo-highlight-code>
<ul>
<li>remote offer 생성</li>
</ul>
<deckgo-highlight-code language="jsx" theme="dracula" line-numbers="true"  >
          <code slot="code">const handleRemoteAnswer = async (answer) =&gt; {
    const remoteAnswer = new RTCSessionDescription(answer);
    await pcRef.current.setRemoteDescription(remoteAnswer);
  };</code>
        </deckgo-highlight-code>
<h3 id="ice-연결--연결-완료" style="position:relative;"><a href="#ice-%EC%97%B0%EA%B2%B0--%EC%97%B0%EA%B2%B0-%EC%99%84%EB%A3%8C" aria-label="ice 연결  연결 완료 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ICE 연결 ~ 연결 완료</h3>
<p><img src="%25EC%25BA%25A1%25EC%25B2%259811.png" alt="캡처11.PNG"></p>
<ul>
<li>ice gathering이 완료되면 시그널링 서버로 알리고, 참가자들은 다시 서버로부터 알림을 받아 ice candidate를 추가한다.</li>
</ul>
<deckgo-highlight-code language="jsx" theme="dracula" line-numbers="true"  >
          <code slot="code">pcRef.current.addEventListener(&#39;icegatheringstatechange&#39;, () =&gt; {
      if (
        pcRef.current.signalingState === &#39;stable&#39; &amp;&amp;
        pcRef.current.iceGatheringState === &#39;complete&#39;
      ) {
        socketRef.current.emit(&#39;new-ice&#39;, {
          iceCandidates: iceCandidateRef.current,
          roomId: roomIdRef.current,
        });
      }
    });

//
socket.on(&#39;remote-ice&#39;, ({ iceCandidates }) =&gt; {
      iceCandidates.forEach((candidate) =&gt; {
        pcRef.current.addIceCandidate(candidate);
      });
    });</code>
        </deckgo-highlight-code>
<ul>
<li>track 이벤트를 감지하면 리모트의 영상을 틀어준다.</li>
<li><strong>1:1 Mesh 연결 완료!</strong></li>
</ul>
<deckgo-highlight-code language="jsx" theme="dracula" line-numbers="true"  >
          <code slot="code">pcRef.current.addEventListener(&#39;track&#39;, (event) =&gt; {
      const [remoteStream] = event.streams;
      remoteVideoRef.current.srcObject = remoteStream;
 });</code>
        </deckgo-highlight-code>
<h2 id="5-모면-프로젝트에는-어떻게-쓰나요" style="position:relative;"><a href="#5-%EB%AA%A8%EB%A9%B4-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%EC%97%90%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%93%B0%EB%82%98%EC%9A%94" aria-label="5 모면 프로젝트에는 어떻게 쓰나요 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 모면 프로젝트에는 어떻게 쓰나요?</h2>
<p><img src="%25EC%25BA%25A1%25EC%25B2%25987.png" alt="캡처7.PNG"></p>
<ul>
<li>Mesh 방식은 3~4명 이상이 연결되면 정상적인 통신이 힘들어진다고 한다.(수 년전 기준)
<ul>
<li>우리 프로젝트는 최대 6명 기준으로 기획했다.</li>
</ul>
</li>
<li>그래서 나온 대체방식이 위에서 소개한 MCU와 SFU.
<ul>
<li>MCU 방식은 서버의 부담이 너무 커질 우려가 있다고 생각했다. (서버에서 미디어 데이터를 합치는 데 들어가는 추가비용)</li>
<li>SFU 방식을 사용하자.</li>
</ul>
</li>
<li>SFU 서버로 사용할 오픈소스 라이브러리 비교: mediasoup vs janus-gateway
<ul>
<li>mediasoup는 node 패키지, janus는 기본적으로 c 기반이고 노드 패키지도 지원함</li>
<li>팀원 모두가 js에 익숙함. mediasoup가 janus에 비해 최근 커뮤니티 글이 활발하고 참고자료가 이해하기 수월하다.</li>
<li>mediasoup로 결정, 필요 시 coturn(TURN 서버 오픈소스 라이브러리)으로 TURN 서버 구성</li>
</ul>
</li>
</ul>
<h2 id="참고" style="position:relative;"><a href="#%EC%B0%B8%EA%B3%A0" aria-label="참고 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>참고</h2>
<p><strong><a href="https://gabrieltanner.org/blog/turn-server/" target="_blank" rel="nofollow">How to set up and configure your own TURN server using Coturn</a></strong></p>
<p><a href="https://www.dacast.com/blog/video-streaming-protocol/" target="_blank" rel="nofollow"><strong>video-streaming-protocol</strong></a></p>
<p><a href="https://github.com/jasonkang14/webrtc-web-client" target="_blank" rel="nofollow">webrtc-web-client - jasonkang14</a></p></div></div><div></div><style data-emotion="css w56or9">.css-w56or9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding:50px 0;text-align:center;}.css-w56or9 a{font-size:15px;color:#f8f8f2;}</style><div class="css-w56or9 evi8j960"><a>© SeungheonShin Powered By Gatsby.</a></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2022/12/10/WebRTC-맛보기/";window.___webpackCompilationHash="ca2a7fc71522812ef5be";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-c9fa82aa5b1f9c65f078.js"],"app":["/app-6a3c13f7fe5a23cc2022.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-a820bb33b1eda0d6b91f.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-8ee85ce5b1349fc4ece1.js"],"component---src-templates-post-template-tsx":["/component---src-templates-post-template-tsx-a2c867ec1ccae1451131.js"]};/*]]>*/</script><script src="/polyfill-c9fa82aa5b1f9c65f078.js" nomodule=""></script><script src="/app-6a3c13f7fe5a23cc2022.js" async=""></script><script src="/framework-c45ea1cbb39153ed5c73.js" async=""></script><script src="/webpack-runtime-0021954739cc4311236d.js" async=""></script></body></html>